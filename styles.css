/* ===== 8-bit Pokémon Vibe ===== */
:root{
  /* Game Boy-ish greens with a modern twist */
  --bg-0:#0b1f12;     /* darkest */
  --bg-1:#163a21;     /* dark */
  --panel:#224f2c;    /* mid */
  --panel-2:#2c6a3a;  /* mid+ */
  --light:#9bbc0f;    /* GB light */
  --mid:#8bac0f;      /* GB mid */
  --accent:#ffcc00;   /* UI highlight */
  --accent-2:#ff5d5d; /* danger/hover */
  --text:#e9ffd6;

  /* FX */
  --scanline:rgba(0,0,0,.08);
  --vignette:rgba(0,0,0,.25);
  --shadow:rgba(0,0,0,.6);

  --pad:14px;
  --radius:0; /* keep it pixel-straight */
}

* { box-sizing:border-box; }
html, body { height:100%; }
body{
  margin:0; color:var(--text);
  font-family:"Press Start 2P","VT323",monospace;
  letter-spacing:.5px;
  background:
    /* big soft vignette */
    radial-gradient(120% 100% at 50% 50%, transparent 60%, var(--vignette) 100%),
    /* checker/dither */
    repeating-linear-gradient(45deg, var(--bg-0) 0 6px, var(--bg-1) 6px 12px);
  overflow: hidden; /* Prevent scrollbars from appearing on mobile */
}

/* Optional CRT scanlines—always on. Remove if you don’t want it */
body::after{
  content:"";
  position:fixed; inset:0; pointer-events:none;
  background:
    repeating-linear-gradient(to bottom, var(--scanline) 0 2px, transparent 2px 4px);
  mix-blend-mode:multiply;
}

/* Layout wrapper */
.main {
  display:grid; place-items:center; min-height:100dvh;
  padding:var(--pad);
  width: 100%; /* Ensure main content area uses full width */
}

/* ==== Canvas frame (your #game canvas) ==== */
#game{
  image-rendering: pixelated;
  image-rendering: crisp-edges;
  background: linear-gradient(180deg, #0e2717, #0c2114);
  outline: none;
  /* pixel bezel using stepped box-shadows */
  box-shadow:
    0 0 0 4px #04140b,
    0 0 0 8px #113720,
    0 0 0 12px #1a4a2b,
    0 12px 0 12px rgba(0,0,0,.45);
  border-radius: var(--radius);
  /* Make canvas responsive */
  width: 100%;
  height: auto;
  max-width: 960px; /* Limit max size to original dimensions */
}

/* ===== Player HUD ===== */
#player-hud {
  position: fixed;
  top: 10px;
  left: 10px;
  right: 10px;
  display: flex;
  gap: 10px;
  z-index: 50;
  pointer-events: none;
  flex-wrap: wrap;
}
.player-card {
  background: rgba(11, 31, 18, 0.75);
  border: 3px solid #163a21;
  padding: 8px;
  display: flex;
  align-items: center;
  gap: 8px;
  width: 250px; /* Increased width for new elements */
  box-shadow: 0 4px 0 rgba(0,0,0,.3);
  pointer-events: all;
}
.player-card .portrait {
  width: 50px;
  height: 50px;
  background: #0b1f12;
  border: 2px solid #2c6a3a;
  image-rendering: pixelated;
}
.player-card .info {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  gap: 5px;
}
.player-card .username {
  font-size: 12px;
  color: var(--text);
  text-shadow: 1px 1px 0 #000;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.player-card .hp-bar-bg {
  width: 100%;
  height: 12px;
  background: #0b1f12;
  border: 2px solid #2c6a3a;
}
.player-card .hp-bar {
  height: 100%;
  background: linear-gradient(to right, #4caf50, #8bc34a);
  width: 100%;
  transition: width 0.3s ease-out;
}
.player-card .xp-bar-bg {
  width: 100%;
  height: 8px;
  background: #0b1f12;
  border: 2px solid #2c6a3a;
}
.player-card .xp-bar {
  height: 100%;
  background: linear-gradient(to right, #3a7bd5, #3a97d5);
  width: 0%;
  transition: width 0.3s ease-out;
}
.player-card .coins {
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 14px;
  color: var(--accent);
  text-shadow: 1px 1px 0 #000;
}
.player-card .coin-icon {
  width: 16px;
  height: 16px;
  image-rendering: pixelated;
}


/* ===== Overlays ===== */
.hidden{ display:none !important; }

/* Character select overlay and Auth overlay share the same base look */
#select,
#lobbies,
#input-select,
.auth-overlay{
  position:fixed; inset:0; z-index:10;
  display:flex; align-items:center; justify-content:center;
  padding:calc(var(--pad) * 1.2);
  background:
    linear-gradient(180deg, rgba(0,0,0,.5), rgba(0,0,0,.65)),
    radial-gradient(120% 100% at 50% 0%, transparent 30%, rgba(0,0,0,.4) 100%),
    repeating-linear-gradient(45deg, rgba(255,255,255,.035) 0 6px, transparent 6px 12px);
  backdrop-filter: blur(1px);
}

/* Title & hint text inside overlays */
#select h1, #select p, #lobbies h1, #input-select h1 {
  margin:0 0 16px; text-align:center;
  text-shadow:0 2px 0 #0a2d1a, 0 0 10px rgba(155,188,15,.35);
}

#online-count-container {
    background: rgba(0, 0, 0, 0.4);
    padding: 8px 12px;
    border-radius: 4px;
    border: 2px solid var(--panel-2);
    font-size: 12px;
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 20px;
}

#online-indicator {
    width: 10px;
    height: 10px;
    background-color: #3cff3c;
    border-radius: 50%;
    box-shadow: 0 0 8px #3cff3c;
}


/* ==== Character grid ==== */
#charGrid{
  display:grid; gap:10px;
  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  width:min(1100px, 95vw);
}

/* ==== Character card buttons ==== */
.card{
  display:flex; flex-direction:column; align-items:center; gap:10px;
  cursor:pointer; border:none; background:transparent; color:var(--text);
  padding:18px 14px; text-align:center;
  text-transform:uppercase; letter-spacing:.6px;
  transition: transform .06s ease-out, filter .06s ease-out;
  /* pixel frame */
  box-shadow:
    0 0 0 3px #04140b,
    0 0 0 6px #153f26,
    0 6px 0 6px rgba(0,0,0,.45);
  background:
    linear-gradient(180deg, var(--panel) 0%, var(--panel-2) 100%);
}
.card img{
  width:120px; height:120px; object-fit:contain; image-rendering:pixelated;
  filter: drop-shadow(0 3px 0 rgba(0,0,0,.35));
}
.card span{
  font-size:12px; line-height:1.2;
  padding:6px 8px;
  background:#0f2c19;
  box-shadow: inset 0 0 0 2px #071b10;
}
.card:focus-visible{ outline:2px solid var(--accent); outline-offset:3px; }
.card:hover{ transform: translateY(-2px); filter: saturate(1.2); }
.card:active{ transform: translateY(1px); }

.small-card {
  width: 120px;
  height: 120px;
  padding: 8px;
}
.small-card img {
  width: 64px;
  height: auto;
}
.small-card span {
  font-size: 10px;
  margin-top: 6px;
  line-height: 1.1;
}

/* ==== Buttons ==== */
.button8{
  display:inline-block; padding:10px 12px; color:#1b1500; background:var(--accent);
  text-decoration:none; cursor:pointer; user-select:none;
  border: none;
  font-family: inherit;
  box-shadow:
    0 0 0 3px #6a5300 inset,
    0 4px 0 0 #caa400,
    0 8px 0 0 rgba(0,0,0,.35);
}
.button8:active{ transform: translateY(2px); box-shadow:
  0 0 0 3px #6a5300 inset,
  0 2px 0 0 #caa400,
  0 4px 0 0 rgba(0,0,0,.35);
}

.leave-lobby-btn {
    position: fixed;
    top: 10px;
    right: 140px; /* Position it to the left of the sign out button */
    z-index: 101;
}


/* ==== Auth form niceties (labels/inputs/errors) ==== */
.card h2{margin:0 0 10px 0;font-size:18px;}
.card label{display:block;margin:10px 0 4px 2px;font-size:12px;opacity:.9;}
.card input{
  width:100%; padding:10px 12px; border-radius:10px;
  border:2px solid var(--panel-2); background:#0f2a22; color:var(--text);
  font-family: inherit;
  font-size:14px; outline:none;
  box-shadow: inset 0 0 0 2px #071b10;
}
.auth-error{color:#ff9a9a;margin:8px 0 0 0;min-height:1.4em;text-align:center;font-size:12px;}

/* Chat HUD log */
#chatLog{
  position: fixed;
  left: 12px; bottom: 12px;
  width: min(420px, 45vw);
  max-height: 40vh;
  overflow-y: auto;
  overflow-x: hidden;
  background: rgba(9, 22, 26, 0.65);
  border: 2px solid #2a6473;
  padding: 8px;
  color: #dff8ff;
  font-family: "Press Start 2P", monospace;
  font-size: 10px;
  line-height: 1.35;
  backdrop-filter: blur(2px);
  border-radius: 8px;
  z-index: 99;
}
#chatLog .chatItem { 
    margin: 2px 0; 
    white-space: pre-wrap; 
    word-break: break-word; 
}
#chatLog .chatItem.system {
    color: #9bd5e0;
    font-style: italic;
}
#chatLog .chat-ts {
    opacity: 0.6;
    margin-right: 6px;
}



/* Mobile Controls */
#mobile-controls {
  position: fixed;
  bottom: 20px;
  left: 20px;
  right: 20px;
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
  pointer-events: none;
  z-index: 100;
  -webkit-user-select: none;
  user-select: none;
}

#d-pad {
  position: relative;
  width: 180px;
  height: 180px;
  background: rgba(11, 31, 18, 0.5);
  border-radius: 50%;
  border: 4px solid #163a21;
  pointer-events: all;
}

.d-pad-btn {
  position: absolute;
  width: 60px;
  height: 60px;
  background: rgba(44, 106, 58, 0.7);
}
.d-pad-btn:active {
  background: rgba(155, 188, 15, 0.8);
}

.d-pad-btn.up { top: 0; left: 50%; transform: translateX(-50%); border-top-left-radius: 10px; border-top-right-radius: 10px; }
.d-pad-btn.down { bottom: 0; left: 50%; transform: translateX(-50%); border-bottom-left-radius: 10px; border-bottom-right-radius: 10px; }
.d-pad-btn.left { left: 0; top: 50%; transform: translateY(-50%); border-top-left-radius: 10px; border-bottom-left-radius: 10px; }
.d-pad-btn.right { right: 0; top: 50%; transform: translateY(-50%); border-top-right-radius: 10px; border-bottom-right-radius: 10px; }

#action-buttons {
  display: flex;
  flex-direction: column;
  gap: 10px;
  pointer-events: all;
}

.mobile-action-btn {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  font-size: 16px;
  font-weight: bold;
  color: var(--text);
  background: var(--panel-2);
  border: 4px solid #163a21;
  box-shadow: 0 4px 0 rgba(0,0,0,.3);
  font-family: inherit;
  cursor: pointer;
}
.mobile-action-btn:active {
  transform: translateY(2px);
  box-shadow: 0 2px 0 rgba(0,0,0,.3);
}

/* Mobile Chat Overlay */
#mobile-chat-overlay {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background: #0b1c21;
  border-top: 2px solid #2a6473;
  z-index: 101;
}
#mobile-chat-form {
  display: flex;
  padding: 8px;
}
#mobile-chat-input {
  flex-grow: 1;
  border: 2px solid var(--panel-2);
  background: #0f2a22;
  color: var(--text);
  font-family: inherit;
  padding: 10px;
  font-size: 14px;
  border-radius: 0;
}
#mobile-chat-form button {
  padding: 10px 15px;
  border: none;
  background: var(--accent);
  color: #1b1500;
  font-family: inherit;
  font-size: 14px;
  cursor: pointer;
}


/* ==== Responsive niceties ==== */
@media (max-width: 720px){
  #charGrid {
    grid-template-columns: repeat(auto-fill, minmax(85px, 1fr));
    gap: 8px;
  }
  .small-card {
    width: 85px;
    height: 85px;
    padding: 5px;
    gap: 3px;
  }
  .small-card img {
    width: 42px;
    height: 42px;
  }
  .small-card span {
    font-size: 8px;
    line-height: 1;
    padding: 2px 3px;
  }
  #player-hud {
    flex-direction: column;
    align-items: flex-start;
    gap: 5px;
  }
  .player-card {
    width: 180px;
  }
}

@media (max-width: 480px) {
  .main {
    padding: 5px;
  }
  #mobile-controls {
    bottom: 10px;
    left: 10px;
    right: 10px;
  }
  #d-pad {
    width: 140px;
    height: 140px;
  }
  .d-pad-btn {
    width: 46px;
    height: 46px;
  }
  .mobile-action-btn {
    width: 70px;
    height: 70px;
    font-size: 14px;
  }
}

/* Shop and Inventory */
.shop-icon-container {
    position: fixed;
    top: 95px;
    left: 10px;
    z-index: 101;
    cursor: pointer;
}

.shop-icon-container img {
    width: 50px;
    height: 50px;
}

.shop-modal {
    position: fixed;
    inset: 0;
    z-index: 110;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(2px);
}

.shop-content {
    background: var(--bg-1);
    border: 4px solid var(--panel-2);
    padding: 20px;
    width: 80%;
    max-width: 600px;
    max-height: 80vh;
    overflow-y: auto;
}

#shop-items {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 15px;
    margin-bottom: 20px;
}

.shop-item {
    background: var(--panel);
    border: 2px solid var(--panel-2);
    padding: 10px;
    text-align: center;
}

.shop-item h4 {
    margin: 0 0 10px;
    color: var(--accent);
}

.shop-item p {
    font-size: 10px;
    margin: 0 0 10px;
}

.inventory-display {
    position: fixed;
    bottom: 10px;
    right: 10px;
    width: 200px;
    background: rgba(11, 31, 18, 0.75);
    border: 3px solid #163a21;
    padding: 10px;
    z-index: 50;
}

.inventory-display h3 {
    margin: 0 0 10px;
    text-align: center;
    font-size: 14px;
}

#inventory-items {
    display: flex;
    flex-direction: column;
    gap: 5px;
}

.inventory-item {
    background: var(--panel);
    padding: 5px;
    font-size: 12px;
    cursor: pointer;
}

.inventory-item.equipped {
    border: 2px solid var(--accent);
}

/* Leaderboard */
.leaderboard-container {
    position: fixed;
    top: 10px;
    left: 10px;
    width: 250px;
    background: rgba(11, 31, 18, 0.75);
    border: 3px solid #163a21;
    padding: 10px;
    z-index: 50;
    color: var(--text);
}

.leaderboard-container h3 {
    margin: 0 0 10px;
    text-align: center;
    font-size: 14px;
    color: var(--accent);
}

.leaderboard-container ol {
    margin: 0;
    padding: 0 0 0 20px;
    font-size: 12px;
}

.leaderboard-container li {
    margin-bottom: 5px;
}
